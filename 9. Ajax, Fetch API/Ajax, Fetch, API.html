<!DOCTYPE html>
<html>
<head>
<title>Ajax, Fetch, API.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="ajax-fetch-api">Ajax, Fetch API</h1>
<p><a href="https://xdevclass.com/phan-6-json-va-ajax-trong-javascript/">B·∫£n g·ªëc: Ph·∫ßn 6 (Ph·∫ßn cu·ªëi): JSON v√† Ajax trong Javascript</a></p>
<h2 id="json">JSON</h2>
<p>JSON (<strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation) l√† m·ªôt chu·ªói text ƒë∆∞·ª£c vi·∫øt d∆∞·ªõi d·∫°ng Javascript Object d√πng ƒë·ªÉ l∆∞u tr·ªØ v√† trao ƒë·ªïi d·ªØ li·ªáu.</p>
<p>JSON th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ l∆∞u tr·ªØ string, number, boolean, array, object, null.</p>
<p>ƒê·ªãnh d·∫°ng JSON c√≥ th·ªÉ d·ªÖ d√†ng s·ª≠ d·ª•ng ·ªü c√°c ng√¥n ng·ªØ l·∫≠p tr√¨nh kh√°c nhau. ·ªû Javascript b·∫°n c√≥ th·ªÉ thao t√°c v·ªõi JSON th√¥ng qua <code>JSON.parse()</code> v√† <code>JSON.stringify()</code></p>
<h3 id="chuy%E1%BB%83n-object-th%C3%A0nh-json">Chuy·ªÉn Object th√†nh JSON</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> myObj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">cars</span>: [<span class="hljs-string">'Ford'</span>, <span class="hljs-string">'BMW'</span>, <span class="hljs-string">'Fiat'</span>]
}
<span class="hljs-keyword">const</span> myJSON = <span class="hljs-built_in">JSON</span>.stringify(myObj)
<span class="hljs-built_in">console</span>.log(myJSON) <span class="hljs-comment">// '{"name":"John","age":30,"cars":["Ford","BMW","Fiat"]}'</span>
</div></code></pre>
<h3 id="chuy%E1%BB%83n-json-th%C3%A0nh-object">Chuy·ªÉn JSON th√†nh Object</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Ch√∫ √Ω l√† d√πng d·∫•u ' ho·∫∑c ` ngo√†i c√πng th√¨ JS m·ªõi cho ph√©p</span>
<span class="hljs-keyword">const</span> myJSON = <span class="hljs-string">`{"name":"John","age":30,"cars":["Ford","BMW","Fiat"]}`</span>
<span class="hljs-keyword">const</span> myObj = <span class="hljs-built_in">JSON</span>.parse(myJSON)
</div></code></pre>
<h3 id="c%C3%BA-ph%C3%A1p-json">C√∫ ph√°p JSON</h3>
<ul>
<li>Data l√† c·∫∑p name/value</li>
<li>Data ƒë∆∞·ª£c ngƒÉn c√°ch b·ªüi d·∫•u ph·∫©y</li>
<li>Ngo·∫∑c nh·ªçn m√¥ t·∫£ object</li>
<li>Ngo·∫∑c vu√¥ng m√¥ t·∫£ array</li>
<li>JSON d·∫•u nh√°y k√©p</li>
<li>Tr∆∞·ªùng name ph·∫£i b·ªçc trong nh√°y k√©p</li>
</ul>
<h2 id="value-trong-json-ph%E1%BA%A3i-l%C3%A0-m%E1%BB%99t-trong-nh%E1%BB%AFng-ki%E1%BB%83u-d%E1%BB%AF-li%E1%BB%87u-d%C6%B0%E1%BB%9Bi-%C4%91%C3%A2y">Value trong JSON ph·∫£i l√† m·ªôt trong nh·ªØng ki·ªÉu d·ªØ li·ªáu d∆∞·ªõi ƒë√¢y</h2>
<ul>
<li>string</li>
<li>number</li>
<li>object</li>
<li>array</li>
<li>boolean</li>
<li>null</li>
</ul>
<h2 id="array-v%C3%A0-json">Array v√† JSON</h2>
<pre class="hljs"><code><div><span class="hljs-comment">// Array</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-string">'Ford'</span>, <span class="hljs-string">'BMW'</span>, <span class="hljs-string">'Fiat'</span>]
<span class="hljs-comment">// JSON</span>
<span class="hljs-keyword">const</span> json = <span class="hljs-string">'[ "Ford", "BMW", "Fiat" ]'</span>
</div></code></pre>
<p>Ngo√†i c√°c gi√° tr·ªã ƒë∆∞·ª£c n√™u b√™n tr√™n th√¨ c√°c gi√° tr·ªã nh∆∞ <strong>Function, undefined, NaN, Infinity</strong>,‚Ä¶ s·∫Ω kh√¥ng ƒë∆∞·ª£c chuy·ªÉn sang JSON nh√©</p>
<pre class="hljs"><code><div><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-number">30</span>
  },
  <span class="hljs-attr">city</span>: <span class="hljs-string">'New York'</span>
}
<span class="hljs-keyword">var</span> myJSON = <span class="hljs-built_in">JSON</span>.stringify(obj)
<span class="hljs-built_in">console</span>.log(myJSON) <span class="hljs-comment">// '{"name":"John","city":"New York"}'</span>
</div></code></pre>
<h2 id="ajax">AJAX</h2>
<p>AJAX = <strong>A</strong>synchronous <strong>J</strong>avaScript <strong>A</strong>nd <strong>X</strong>ML.</p>
<p>AJAX kh√¥ng ph·∫£i l√† m·ªôt ng√¥n ng·ªØ l·∫≠p tr√¨nh</p>
<p>AJAX ch·ªâ l√† s·ª± k·∫øt h·ª£p c·ªßa</p>
<ul>
<li>XMLHttpRequest object c√≥ s·∫µn tr√™n tr√¨nh duy·ªát (d√πng ƒë·ªÉ g·ª≠i v√† nh·∫≠n data t·ª´ web server)</li>
<li>Javascript v√† HTML DOM (ƒë·ªÉ hi·ªÉn th·ªã ho·∫∑c s·ª≠ d·ª•ng data)</li>
</ul>
<p>C√°i t√™n AJAX d·ªÖ g√¢y hi·ªÉu l·∫ßm l√† ·ª©ng d·ª•ng d√πng AJAX s·∫Ω s·ª≠ d·ª•ng XML (m·ªôt ki·ªÉu data nh∆∞ JSON nh∆∞ng ph·ª©c t·∫°p h∆°n) ƒë·ªÉ g·ª≠i v√† nh·∫≠n d·ªØ li·ªáu. Nh∆∞ng tr√™n th·ª±c t·∫ø th√¨ ch√∫ng ta ch·ªß y·∫øu d√πng text ho·∫∑c JSON ƒë·ªÉ trao ƒë·ªïi d·ªØ li·ªáu.</p>
<p>AJAX gi√∫p ch√∫ng ta ƒë·ªçc d·ªØ li·ªáu t·ª´ server tr·∫£ v·ªÅ, g·ª≠i d·ªØ li·ªáu l√™n server ·ªü ch·∫ø ƒë·ªô ng·∫ßm, c·∫≠p nh·∫≠t trang web m√† kh√¥ng c·∫ßn reload l·∫°i trang. V√¨ s·ª± ti·ªán l·ª£i c·ªßa AJAX m√† ch√∫ng ta ƒë√£ c√≥ React, Angular v√† Vue üòÜ</p>
<h3 id="c%C3%A1ch-ajax-ho%E1%BA%A1t-%C4%91%E1%BB%99ng">C√°ch AJAX ho·∫°t ƒë·ªông</h3>
<p><img src="pic_ajax.gif" alt="Ajax"></p>
<ol>
<li>M·ªôt s·ª± ki·ªán x·∫£y ra ·ªü trang web (trang ƒë∆∞·ª£c load, m·ªôt button ƒë∆∞·ª£c click)</li>
<li>M·ªôt XMLHttpRequest object ƒë∆∞·ª£c t·∫°o b·ªüi Javascript</li>
<li>XMLHttpRequest object g·ª≠i m·ªôt request ƒë·∫øn web server</li>
<li>Server x·ª≠ l√Ω request ƒë√≥</li>
<li>Server g·ª≠i response v·ªÅ cho trang web</li>
<li>Response ƒë∆∞·ª£c ƒë·ªçc b·ªüi Javascript</li>
<li>Th·ª±c hi·ªán m·ªôt s·ªë h√†nh ƒë·ªông tr√™n trang web b·∫±ng Javascript (v√≠ d·ª• nh∆∞ c·∫≠p nh·∫≠t l·∫°i trang)</li>
</ol>
<h3 id="xmlhttprequest">XMLHttpRequest</h3>
<p>XMLHttpRequest (XHR) l√† m·ªôt constructor function (m√¨nh ƒë√£ gi·ªõi thi·ªáu v·ªÅ constructor function trong <img src="https://xdevclass.com/phan-3-thao-tac-voi-number-string-array-object-va-class-trong-javascript/" alt="b√†i n√†y">) d√πng ƒë·ªÉ giao ti·∫øp v·ªõi server. XHR c≈©ng l√† m·ªôt Web APIs n√™n n√≥ ch·ªâ c√≥ tr√™n m√¥i tr∆∞·ªùng tr√¨nh duy·ªát, kh√¥ng xu·∫•t hi·ªán ·ªü Node.js nha :mrgreen:</p>
<h3 id="t%E1%BA%A1o-m%E1%BB%99t-xmlhttprequest-object">T·∫°o m·ªôt XMLHttpRequest object</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">var</span> xhttp = <span class="hljs-keyword">new</span> XMLHttpRequest()
</div></code></pre>
<h3 id="m%E1%BB%99t-s%E1%BB%91-ph%C6%B0%C6%A1ng-th%E1%BB%A9c-c%E1%BB%A7a-xmlhttprequest-object">M·ªôt s·ªë ph∆∞∆°ng th·ª©c c·ªßa XMLHttpRequest object</h3>
<table>
<thead>
<tr>
<th>Ph∆∞∆°ng th·ª©c</th>
<th>M√¥ t·∫£</th>
</tr>
</thead>
<tbody>
<tr>
<td>new XMLHttpRequest()</td>
<td>T·∫°o m·ªõi XMLHttpRequest object</td>
</tr>
<tr>
<td>abort()</td>
<td>H·ªßy request hi·ªán t·∫°i</td>
</tr>
<tr>
<td>getAllResponseHeaders()</td>
<td>Returns t·∫•t c·∫£ th√¥ng tin header</td>
</tr>
<tr>
<td>getResponseHeader()</td>
<td>Returns th√¥ng tin header ch·ªâ ƒë·ªãnh</td>
</tr>
<tr>
<td>open(method, url, async, user, psw)</td>
<td>Quy ƒë·ªãnh request; method: Lo·∫°i request (GET, POST, PUT, DELETE); url: ƒë∆∞·ªùng d·∫´n ƒë·∫øn server; async: true (b·∫•t ƒë·ªìng b·ªô) ho·∫∑c false (ƒë·ªìng b·ªô); user: t√πy ch·ªçn username; psw: t√πy ch·ªçn password</td>
</tr>
<tr>
<td>send(body)</td>
<td>G·ª≠i body data ƒë·∫øn server. body c√≥ th·ªÉ l√†; Document, c·∫ßn serialized tr∆∞·ªõc khi g·ª≠i; Blob, BufferSource, FormData, URLSearchParams, or USVString object.null; N·∫øu kh√¥ng c√≥ gi√° tr·ªã n√†o cho body th√¨ m·∫∑c ƒë·ªãnh null ƒë∆∞·ª£c s·ª≠ d·ª•ng.</td>
</tr>
<tr>
<td>setRequestHeader()</td>
<td>Th√™m c√°c gi√° tr·ªã v√†o trong header request</td>
</tr>
</tbody>
</table>
<h3 id="m%E1%BB%99t-s%E1%BB%91-thu%E1%BB%99c-t%C3%ADnh-c%E1%BB%A7a-xmlhttprequest-object">M·ªôt s·ªë thu·ªôc t√≠nh c·ªßa XMLHttpRequest object</h3>
<table>
<thead>
<tr>
<th>Thu·ªôc t√≠nh</th>
<th>M√¥ t·∫£</th>
</tr>
</thead>
<tbody>
<tr>
<td>onreadystatechange</td>
<td>X√°c ƒë·ªãnh m·ªôt function ƒë∆∞·ª£c g·ªçi khi thu·ªôc t√≠nh readyState thay ƒë·ªïi</td>
</tr>
<tr>
<td>readyState</td>
<td>M√¥ t·∫£ tr·∫°ng th√°i c·ªßa XMLHttpRequest.0: request ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o. 1: k·∫øt n·ªëi v·ªõi server ƒë∆∞·ª£c thi·∫øt l·∫≠p. 2: request ƒë∆∞·ª£c server ti·∫øp nh·∫≠n. 3: ƒëang x·ª≠ l√Ω request. 4: request k·∫øt th√∫c v√† response ƒë√£ s·∫µn s√†ng ƒë·ªÉ d√πng</td>
</tr>
<tr>
<td>responseText</td>
<td>Return v·ªÅ response nh∆∞ m·ªôt string</td>
</tr>
<tr>
<td>responseXML</td>
<td>Return v·ªÅ response nh∆∞ m·ªôt XML</td>
</tr>
<tr>
<td>status</td>
<td>Return v·ªÅ status c·ªßa request. 200: ‚ÄúOK‚Äù. 403: ‚ÄúForbidden‚Äù. 404: ‚ÄúNot Found‚Äù. Xem danh s√°ch ƒë·∫ßy ƒë·ªß t·∫°i <a href="https://www.w3schools.com/tags/ref_httpmessages.asp">Http Messages Reference</a></td>
</tr>
<tr>
<td>statusText</td>
<td>Return v·ªÅ status d·∫°ng text (V√≠ d·ª• ‚ÄúOK‚Äù ho·∫∑c ‚ÄúNot Found‚Äù)</td>
</tr>
</tbody>
</table>
<h3 id="v%C3%AD-d%E1%BB%A5-v%E1%BB%81-c%C3%A1ch-d%C3%B9ng-xhr-%C4%91%E1%BB%83-get">V√≠ d·ª• v·ªÅ c√°ch d√πng XHR ƒë·ªÉ GET</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadDoc</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> xhttp = <span class="hljs-keyword">new</span> XMLHttpRequest()
  <span class="hljs-comment">// function n√†y s·∫Ω ch·∫°y m·ªói khi readyState thay ƒë·ªïi</span>
  xhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// Khi request th√†nh c√¥ng</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.readyState == <span class="hljs-number">4</span> &amp;&amp; <span class="hljs-keyword">this</span>.status == <span class="hljs-number">200</span>) {
      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'demo'</span>).innerHTML = <span class="hljs-keyword">this</span>.responseText
    }
  }
  xhttp.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://httpbin.org/get'</span>, <span class="hljs-literal">true</span>)
  xhttp.send()
}
loadDoc()
</div></code></pre>
<h3 id="v%C3%AD-d%E1%BB%A5-v%E1%BB%81-c%C3%A1ch-d%C3%B9ng-xhr-%C4%91%E1%BB%83-post">V√≠ d·ª• v·ªÅ c√°ch d√πng XHR ƒë·ªÉ POST</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> xhttp = <span class="hljs-keyword">new</span> XMLHttpRequest()
  <span class="hljs-comment">// function n√†y s·∫Ω ch·∫°y m·ªói khi readyState thay ƒë·ªïi</span>
  xhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// Khi request th√†nh c√¥ng</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.readyState == <span class="hljs-number">4</span> &amp;&amp; <span class="hljs-keyword">this</span>.status == <span class="hljs-number">200</span>) {
      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'demo'</span>).innerHTML = <span class="hljs-keyword">this</span>.responseText
    }
  }
  xhttp.open(<span class="hljs-string">'POST'</span>, <span class="hljs-string">'https://httpbin.org/post'</span>, <span class="hljs-literal">true</span>)
  <span class="hljs-keyword">const</span> body = { <span class="hljs-attr">name</span>: <span class="hljs-string">'Du Thanh Duoc'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">24</span>, <span class="hljs-attr">point</span>: <span class="hljs-number">100</span> }
  xhttp.send(<span class="hljs-built_in">JSON</span>.stringify(body))
}
send()
</div></code></pre>
<p>D√πng <code>XMLHttpRequest</code> ƒë·ªÉ x·ª≠ l√Ω AJAX ƒë∆∞·ª£c coi l√† c√°ch ‚Äúc·ªï x∆∞a‚Äù nh·∫•t v√† r∆∞·ªùm r√† nh·∫•t. Ng√†y nay ch√∫ng ta c√≥ r·∫•t nhi·ªÅu t√πy ch·ªçn m·∫°nh m·∫Ω ƒë·ªÉ x·ª≠ l√Ω AJAX. M√¨nh c√≥ th·ªÉ li·ªát k√™ ra</p>
<ul>
<li>N·∫øu d√πng <a href="https://jquery.com/">Jquery</a> th√¨ Jquery cung c·∫•p cho ch√∫ng ta nhi·ªÅu h√†m g·ªçi AJAX r·∫•t ti·ªán l·ª£i nh∆∞ <code>load</code>, <code>ajax</code>, <code>get</code>, <code>getJSON</code></li>
<li>Nh·ªØng tr√¨nh duy·ªát ng√†y n√†y cung c·∫•p m·ªôt API kh√°c <code>XMLHttpRequest</code> ƒë√≥ l√† <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a>, v·ªõi nhi·ªÅu t√≠nh nƒÉng n√¢ng cao v√† c√∫ ph√°p d·ªÖ s·ª≠ d·ª•ng h∆°n <code>XMLHttpRequest</code></li>
<li>Ph·ªï bi·∫øn nh·∫•t ph·∫£i k·ªÉ ƒë·∫øn <a href="https://github.com/axios/axios">Axios</a>, m·ªôt th∆∞ vi·ªán chuy√™n d·ª•ng cho vi·ªác x·ª≠ l√Ω AJAX c≈©ng nh∆∞ g·ªçi API. Cung c·∫•p h√†ng t√° t√≠nh nƒÉng hay, d√πng ƒë∆∞·ª£c cho c·∫£ m√¥i tr∆∞·ªùng tr√¨nh duy·ªát v√† Node (n·∫øu tr√¨nh duy·ªát n√≥ s·∫Ω d·ª±a tr√™n XHR, n·∫øu l√† Node th√¨ l√† <a href="https://nodejs.org/api/http.html">HTTP interface</a>)</li>
</ul>
<h2 id="fetch-api">Fetch API</h2>
<p>Fetch l√† m·ªôt API ƒë∆°n gi·∫£n cung c·∫•p cho ch√∫ng ta kh·∫£ nƒÉng g·ª≠i v√† nh·∫≠n request th√¥ng qua tr√¨nh duy·ªát. N·∫øu nh∆∞ <code>XMLHttpRequest</code> d√πng callback th√¨ Fetch API d√πng Promise, v√¨ th·∫ø s·∫Ω ti·ªán l·ª£i h∆°i khi thao t√°c v√† x·ª≠ l√Ω.</p>
<p>M·ªôt setup request ƒë∆°n gi·∫£n v·ªõi fetch</p>
<pre class="hljs"><code><div>fetch(<span class="hljs-string">'http://example.com/movies.json'</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
  .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(data))
</div></code></pre>
<p>L∆∞u √Ω l√† Promise return t·ª´ <code>fetch()</code> <strong>s·∫Ω kh√¥ng reject d·ª±a tr√™n HTTP error status</strong> ngay c·∫£ khi HTTP 404 ho·∫∑c 500. Thay v√¨ ƒë√≥, n√≥ s·∫Ω resolve b√¨nh th∆∞·ªùng (v·ªõi <code>ok</code> status l√† false), v√† n√≥ ch·ªâ s·∫Ω reject khi m√† m·∫°ng l·ªói ho·∫∑c b·∫•t c·ª© ƒëi·ªÅu g√¨ ngƒÉn c·∫£ request ho√†n th√†nh.</p>
<pre class="hljs"><code><div>fetch(<span class="hljs-string">'examples/example.json'</span>)
  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(response.statusText)
    }
    <span class="hljs-comment">// Do stuff with the response</span>
  })
  .catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Looks like there was a problem: \n'</span>, error)
  })
</div></code></pre>
<h3 id="%C4%91%E1%BB%8Dc-m%E1%BB%99t-response">ƒê·ªçc m·ªôt response</h3>
<pre class="hljs"><code><div>fetch(<span class="hljs-string">'examples/example.json'</span>)
  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(response.statusText)
    }
    <span class="hljs-comment">// Read the response as json.</span>
    <span class="hljs-keyword">return</span> response.json()
  })
  .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">responseAsJson</span>) </span>{
    <span class="hljs-comment">// Do stuff with the JSON</span>
    <span class="hljs-built_in">console</span>.log(responseAsJson)
  })
  .catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Looks like there was a problem: \n'</span>, error)
  })
</div></code></pre>
<p>M·∫∑c ƒë·ªãnh n·∫øu kh√¥ng truy·ªÅn tham s·ªë th·ª© 2 th√¨ fetch s·∫Ω d√πng ph∆∞∆°ng th·ª©c GET, c√≤n mu·ªën ch·ªâ r√µ ph∆∞∆°ng th·ª©c nh∆∞ POST, PUT‚Ä¶ th√¨ ph·∫£i truy·ªÅn tham s·ªë th·ª© 2 v√†o.</p>
<p>V√≠ d·ª• POST</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Example POST method implementation:</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postData</span>(<span class="hljs-params">url = <span class="hljs-string">''</span>, data = {}</span>) </span>{
  <span class="hljs-comment">// Default options are marked with *</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>, <span class="hljs-comment">// *GET, POST, PUT, DELETE, etc.</span>
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'cors'</span>, <span class="hljs-comment">// no-cors, *cors, same-origin</span>
    <span class="hljs-attr">cache</span>: <span class="hljs-string">'no-cache'</span>, <span class="hljs-comment">// *default, no-cache, reload, force-cache, only-if-cached</span>
    <span class="hljs-attr">credentials</span>: <span class="hljs-string">'same-origin'</span>, <span class="hljs-comment">// include, *same-origin, omit</span>
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
      <span class="hljs-comment">// 'Content-Type': 'application/x-www-form-urlencoded',</span>
    },
    <span class="hljs-attr">redirect</span>: <span class="hljs-string">'follow'</span>, <span class="hljs-comment">// manual, *follow, error</span>
    <span class="hljs-attr">referrerPolicy</span>: <span class="hljs-string">'no-referrer'</span>, <span class="hljs-comment">// no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url</span>
    <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data) <span class="hljs-comment">// body data type must match "Content-Type" header</span>
  })
  <span class="hljs-keyword">return</span> response.json() <span class="hljs-comment">// parses JSON response into native JavaScript objects</span>
}
postData(<span class="hljs-string">'https://example.com/answer'</span>, { <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }).then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(data) <span class="hljs-comment">// JSON data parsed by `data.json()` call</span>
})
</div></code></pre>

</body>
</html>
